<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.joonzis.mapper.EventMapper">
	<select id="checkSpin" resultType="java.sql.Date">
		SELECT LAST_SPIN FROM EVENT_INFO WHERE MEM_NO=#{mem_no}
	</select>
	
	<update id="savePoint">
		UPDATE EVENT_INFO
		SET
			POINT=POINT+#{point}
		WHERE
			MEM_NO=#{mem_no}
	</update>
	
	<select id="getPoint" resultType="int">
		SELECT POINT FROM EVENT_INFO WHERE MEM_NO=#{mem_no}
	</select>
	
	<select id="getGame1Rank" resultType="org.joonzis.domain.EventVO">
	<![CDATA[	
		SELECT * FROM 
			(SELECT 
				M.MEM_NICK,
				E.GAME_SCORE_1
			FROM 
				EVENT_INFO E 
			INNER JOIN
				MEMBER M ON E.MEM_NO=M.MEM_NO
			ORDER BY GAME_SCORE_1 DESC)
		WHERE ROWNUM<=10
	]]>
	</select>
	<select id="getMyGame1Rank" resultType="org.joonzis.domain.EventVO">
		SELECT * FROM EVENT_INFO
		WHERE MEM_NO=#{mem_no}
	</select>
	
	<update id="saveGameScore1">
		UPDATE EVENT_INFO
		SET
			GAME_SCORE_1=#{game_score_1}
		WHERE
			MEM_NO=#{mem_no}
	</update>
	
	<select id="getGameScore1" resultType="int">
		SELECT GAME_SCORE_1 FROM EVENT_INFO WHERE MEM_NO=#{mem_no}
	</select>
	
	
	
</mapper>